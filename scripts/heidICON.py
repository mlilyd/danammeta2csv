import pandas as pd

def get_heidicon(path, odf=False):
    if odf:
        heidicon_df = pd.read_excel(path, engine='odf')
    else: 
        heidicon_df = pd.read_excel(path)

    to_drop = [
    '_exported_at','_uuid',
    '_objecttype','_global_object_id',
    '_published#_id','_published#easydb_uri',
    '_published#publish_uri','_pool#de-DE',
    '_published#collector','_tags#reference',
    '_tags#shortname','_tags#de-DE','ressourcen:lk_objekt_id[].asset#asset_id',
    'ressourcen:lk_objekt_id[].asset#original_filename','ressourcen:lk_objekt_id[].res_repro_typ#_standard#de-DE',
    'ressourcen:lk_objekt_id[].res_repro_typ#_standard#en-US','ressourcen:lk_objekt_id[].res_relationstyp',
    'ressourcen:lk_objekt_id[].res_perspektive','ressourcen:lk_objekt_id[].res_beschreibung#de-DE',
    'ressourcen:lk_objekt_id[].res_beschreibung#en-US','ressourcen:lk_objekt_id[].res_datierung_norm#from',
    'ressourcen:lk_objekt_id[].res_datierung_norm#to','ressourcen:lk_objekt_id[].res_datierung_freitext',
    'ressourcen:lk_objekt_id[].res_sig','ressourcen:lk_objekt_id[].res_kommentar',
    'ressourcen:lk_objekt_id[].res_lizenz#_global_object_id',
    'ressourcen:lk_objekt_id[].res_lizenz#_id',
    'ressourcen:lk_objekt_id[].res_lizenz#_objecttype',
    'ressourcen:lk_objekt_id[].res_lizenz#_system_object_id',
    'ressourcen:lk_objekt_id[].res_lizenz#_uuid',
    'ressourcen:lk_objekt_id[].res_lizenz#_version',
    'ressourcen:lk_objekt_id[].res_lizenz#_standard#de-DE',
    'ressourcen:lk_objekt_id[].res_lizenz#_standard#en-US',
    'ressourcen:lk_objekt_id[].res_rechteinhaber',
    'ressourcen:lk_objekt_id[].res_rechteinhaber_link',
    'ressourcen:lk_objekt_id[].res_rechteinhaber_link#_standard',
    'ressourcen:lk_objekt_id[].res_rechteinhaber_link#_standard#de-DE',
    'ressourcen:lk_objekt_id[].res_rechteinhaber_link#_standard#en-US',
    'ressourcen:lk_objekt_id[].res_creditline',
    'ressourcen:lk_objekt_id[].res_kommentar_intern',
    'ressourcen:lk_objekt_id[].easydb4id',
    'obj_link[].obj_link_typ#_standard#de-DE',
    'obj_link[].obj_link_typ#_standard#en-US',
    'obj_link[].obj_link_url',
    'obj_link[].obj_link_url#_standard',
    'obj_link[].obj_link_url#_standard#de-DE',
    'obj_link[].obj_link_url#_standard#en-US',
    'obj_link[].obj_link_beschreibung',
    'obj_kommentar_intern',
    'easydb4id',
    'zugehoerige_objekte[].lk_linktypobj#_global_object_id',
    'zugehoerige_objekte[].lk_linktypobj#_id',
    'zugehoerige_objekte[].lk_linktypobj#_objecttype',
    'zugehoerige_objekte[].lk_linktypobj#_system_object_id',
    'zugehoerige_objekte[].lk_linktypobj#_uuid',
    'zugehoerige_objekte[].lk_linktypobj#_version',
    'zugehoerige_objekte[].lk_linktypobj#_standard#de-DE',
    'zugehoerige_objekte[].lk_linktypobj#_standard#en-US',
    'zugehoerige_objekte[].lk_objekte#_global_object_id',
    'zugehoerige_objekte[].lk_objekte#_id',
    'zugehoerige_objekte[].lk_objekte#_objecttype',
    'zugehoerige_objekte[].lk_objekte#_system_object_id',
    'zugehoerige_objekte[].lk_objekte#_uuid',
    'zugehoerige_objekte[].lk_objekte#_version',
    'zugehoerige_objekte[].lk_objekte#_standard#de-DE',
    'zugehoerige_objekte[].lk_objekte#_standard#en-US',
    'zugehoerige_objekte[].lk_bemerkung',
    'ressourcen:lk_objekt_id[0].res_autoren_lok[].res_autor_lok',
    'obj_literatur[].obj_litzitat',
    'obj_literatur[].obj_litlink',
    'obj_literatur[].obj_litlink#_standard',
    'obj_literatur[].obj_litlink#_standard#de-DE',
    'obj_literatur[].obj_litlink#_standard#en-US',
    'obj_meta[].obj_meta_datum',
    'obj_meta[].obj_meta_kommentar',
    'obj_meta[].obj_meta_lizenz#_global_object_id',
    'obj_meta[].obj_meta_lizenz#_id',
    'obj_meta[].obj_meta_lizenz#_objecttype',
    'obj_meta[].obj_meta_lizenz#_system_object_id',
    'obj_meta[].obj_meta_lizenz#_uuid',
    'obj_meta[].obj_meta_lizenz#_version',
    'obj_meta[].obj_meta_lizenz#_standard#de-DE',
    'obj_meta[].obj_meta_lizenz#_standard#en-US',
    'obj_meta[].obj_meta_rechteinhaber',
    'obj_meta[].obj_meta_rechteinhaber_link',
    'obj_meta[].obj_meta_rechteinhaber_link#_standard',
    'obj_meta[].obj_meta_rechteinhaber_link#_standard#de-DE',
    'obj_meta[].obj_meta_rechteinhaber_link#_standard#en-US',
    'obj_meta[].obj_meta_creditline',
    'obj_rechtsstatus#_id',
    'obj_rechtsstatus#_version',
    'obj_rechtsstatus#_objecttype',
    'obj_rechtsstatus#_system_object_id',
    'obj_rechtsstatus#_global_object_id',
    'obj_rechtsstatus#_uuid',
    'obj_rechtsstatus#_standard#de-DE',
    'obj_rechtsstatus#_standard#en-US',
    'ressourcen:lk_objekt_id[0].res_autoren[].res_autor_gnd',
    'ressourcen:lk_objekt_id[0].res_autoren[].res_autor_gnd#_standard',
    'ressourcen:lk_objekt_id[0].res_autoren[].res_autor_gnd#_standard#de-DE',
    'ressourcen:lk_objekt_id[0].res_autoren[].res_autor_gnd#_standard#en-US',
    'obj_bearb[].obj_bearb_datierung_frei',
    'obj_bearb[].obj_bearb_datierung#from',
    'obj_bearb[].obj_bearb_datierung#to',
    'obj_bearb[].obj_bearb_epoche',
    'obj_bearb[].obj_bearb_epoche#_standard',
    'obj_bearb[].obj_bearb_epoche#_standard#de-DE',
    'obj_bearb[].obj_bearb_epoche#_standard#en-US',
    'obj_bearb[].obj_bearb_material',
    'obj_bearb[].obj_bearb_material#_standard',
    'obj_bearb[].obj_bearb_material#_standard#de-DE',
    'obj_bearb[].obj_bearb_material#_standard#en-US',
    'obj_bearb[].obj_bearb_technik',
    'obj_bearb[].obj_bearb_technik#_standard',
    'obj_bearb[].obj_bearb_technik#_standard#de-DE',
    'obj_bearb[].obj_bearb_technik#_standard#en-US',
    'obj_bearb[].obj_bearb_kontext#de-DE',
    'obj_bearb[].obj_bearb_kontext#en-US',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_datum',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_kommentar',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_lizenz#_global_object_id',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_lizenz#_id',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_lizenz#_objecttype',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_lizenz#_system_object_id',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_lizenz#_uuid',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_lizenz#_version',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_lizenz#_standard#de-DE',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_lizenz#_standard#en-US',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_rechteinhaber',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_rechteinhaber_link',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_rechteinhaber_link#_standard',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_rechteinhaber_link#_standard#de-DE',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_rechteinhaber_link#_standard#en-US',
    'ressourcen:lk_objekt_id[0].res_meta[].res_meta_creditline',
    'obj_bearb[0].obj_bearb_urheber[].obj_bearb_urh_person',
    'obj_bearb[0].obj_bearb_urheber[].obj_bearb_urh_person#_standard',
    'obj_bearb[0].obj_bearb_urheber[].obj_bearb_urh_person#_standard#de-DE',
    'obj_bearb[0].obj_bearb_urheber[].obj_bearb_urh_person#_standard#en-US',
    'obj_bearb[0].obj_bearb_urheber[].obj_bearb_urh_zuschreibung#_standard#de-DE',
    'obj_bearb[0].obj_bearb_urheber[].obj_bearb_urh_zuschreibung#_standard#en-US',
    'obj_bearb[0].obj_bearb_urheber[].obj_bearb_urh_rolle#_standard#de-DE',
    'obj_bearb[0].obj_bearb_urheber[].obj_bearb_urh_rolle#_standard#en-US',
    'obj_autoren_lok[].obj_autor_lok_zuschreibung#_global_object_id',
    'obj_autoren_lok[].obj_autor_lok_zuschreibung#_id',
    'obj_autoren_lok[].obj_autor_lok_zuschreibung#_objecttype',
    'obj_autoren_lok[].obj_autor_lok_zuschreibung#_system_object_id',
    'obj_autoren_lok[].obj_autor_lok_zuschreibung#_uuid',
    'obj_autoren_lok[].obj_autor_lok_zuschreibung#_version',
    'obj_autoren[].obj_autor_gnd',
    'obj_autoren[].obj_autor_gnd#_standard',
    'obj_autoren[].obj_autor_gnd#_standard#de-DE',
    'obj_autoren[].obj_autor_gnd#_standard#en-US',
    'obj_autoren[].obj_autor_zuschreibung#_standard#de-DE',
    'obj_autoren[].obj_autor_zuschreibung#_standard#en-US',
    'obj_autoren[].obj_autor_gnd_rolle#_global_object_id',
    'obj_autoren[].obj_autor_gnd_rolle#_id',
    'obj_autoren[].obj_autor_gnd_rolle#_objecttype',
    'obj_autoren[].obj_autor_gnd_rolle#_system_object_id',
    'obj_autoren[].obj_autor_gnd_rolle#_uuid',
    'obj_autoren[].obj_autor_gnd_rolle#_version',
    'obj_autoren[].obj_autor_gnd_rolle#_standard#de-DE',
    'obj_autoren[].obj_autor_gnd_rolle#_standard#en-US'
    ]

    cleaned_df = heidicon_df.drop(to_drop, axis=1)

    to_drop = [
    'obj_herstellungskontext#de-DE',
    'obj_herstellungskontext#en-US',
    'obj_auftrag_kontext',
    'obj_auftrag_datierung_frei',
    'obj_auftrag_datierung_norm#from',
    'obj_auftrag_datierung_norm#to',
    'obj_fund_datierung_frei',
    'obj_fund_datierung_norm#from',
    'obj_fund_datierung_norm#to',
    'obj_fundkontext',
    'obj_eingangsdatum',
    'obj_eingangskontext',
    'obj_rechteinhaber',
    'obj_epoche_freitext',
    'obj_material_technik_alt',
    'obj_datierung_freitext',
    'obj_autoren_lok[].obj_autor_lok_rolle#_standard#de-DE',
    'obj_autoren_lok[].obj_autor_lok_rolle#_uuid',
    'obj_autoren_lok[].obj_autor_lok_rolle#_id',
    'obj_autoren_lok[].obj_autor_lok_rolle#_objecttype',
    'obj_autoren_lok[].obj_autor_lok_rolle#_global_object_id',
    'obj_autoren_lok[].obj_autor_lok_zuschreibung#_standard#de-DE',
    'obj_autoren_lok[].obj_autor_lok_zuschreibung#_standard#en-US',
    'obj_autoren_lok[].obj_autor_lok#_standard#de-DE',
    'obj_autoren_lok[].obj_autor_lok#_uuid',
    'obj_autoren_lok[].obj_autor_lok#_objecttype',
    'obj_autoren_lok[].obj_autor_lok#_id_parent',
        'obj_sig',
    'obj_beschreibung#de-DE',
    'obj_beschreibung#en-US',
    'obj_beschreibung_quelle',
    'obj_zustand#de-DE',
    'obj_zustand#en-US',
    'obj_zustand_quelle',
    'obj_kommentar#de-DE',
    'obj_kommentar#en-US',
    'obj_auflage',
    'obj_druckzustand',
    'obj_druckzustand_quelle',
    'obj_autoren_lok[].obj_autor_lok#_global_object_id',
    'obj_autoren_lok[].obj_autor_lok#_id',
    'obj_titel#de-DE',
    'obj_titel_quelle',
    'obj_sachbegriff',
    'obj_aufbewahrort_gnd_privsammlung',
    'obj_sig',
    ]

    cleaned_df = cleaned_df.drop(to_drop, axis=1)

    return cleaned_df
